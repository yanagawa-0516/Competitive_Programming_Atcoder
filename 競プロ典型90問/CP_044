#include <iostream>
#include <vector>
using namespace std;

int main(){
  int N,Q;
  cin>>N>>Q;
  
  vector<int> A(N);
  for(int i=0;i<N;i++) cin>>A[i];
  
  int firstPtr=0;
  
  for(int iter=0;iter<Q;iter++){
    int T,x,y;
    cin>>T>>x>>y;
    x--;
    y--;
    
    int dummy=0,idx=-1;
    switch(T){
      case 1:
        x=(firstPtr+x)%N,y=(firstPtr+y)%N;
        dummy=A[x];
        A[x]=A[y];
        A[y]=dummy;
        break;
      
      case 2:
        firstPtr--;
        if(firstPtr<0) firstPtr+=N;
        break;
      
      case 3:
        idx=(firstPtr+x)%N;
        cout<<A[idx]<<endl;
        break;
    }
  }
  
  return 0;
}
