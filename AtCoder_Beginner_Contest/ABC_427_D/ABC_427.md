# ABC - D - The Simple Game

[AtCoderBeginnerContest427-D](https://atcoder.jp/contests/abc427/tasks/abc427_d)  

・2025/10/11 回答

# 解説

DP。\
$t="今まで行った手番の数"(=0,\cdots,2K\ )$\
$dp[u][t]="t\ 手目に頂点\ u\ に駒があって両者が残りの手番を行った時の勝者"(=\mathrm{A}\ \mathrm{or}\ \mathrm{B})$\
とする。 $dp[u][2K]=S_u$ であり、 $dp[1][0]$ を求めればよい。\
\
Aliceに着目する。Aliceの手番は $t$ が偶数の時であり頂点 $u$ に対してある辺 $(u,v)$ で $dp[v][t+1]=\mathrm{A}$ ならその辺を選んで進めばよいので $dp[u][t]=\mathrm{A}$ となる。
逆にそういう辺がなければその状態からAliceは勝てないので $dp[u][t]=\mathrm{B}$ となる。\
Bobに着目したときは( $t$ が奇数の時)も同様に考えられる。\
\
計算量は1つのテストケースで " DPの初期化時間 " $+$ "DPを求める時間" であり、 $O(NK+MK)$ になる。全体でも十分高速。
